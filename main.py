class ActionKind(Enum):
    Walking = 0
    Idle = 1
    Jumping = 2
    Dead = 3
@namespace
class SpriteKind:
    Ground = SpriteKind.create()
    Cloud = SpriteKind.create()
def initGround():
    global ground1, ground2
    ground1 = sprites.create(img("""
            ...................................................................................cccc...........................................................................
                    ..................................................................................c....c..........................................................................
                    cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc......ccccccccccccccccc....ccccccccccccccccccccccccccccccccccccccccccccccccccccc
                    .........................................................................................................cccc.....................................................
                    ..................................................................................................................................................................
                    ..cccc..c.......................c..cccc.........................cccc..c.............c..........................cccc..c...........c..ccc.................c..ccc....
                    ..................................................................................................................................................................
                    ...............cccc..c.........................cccc.c.......c..............cc.c........cccc..c.....cccc..c..................c...............cccc..c...............
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
        """),
        SpriteKind.Ground)
    ground2 = sprites.create(img("""
            .....................................................cccc..................cccc...................................................................................
                    ....................................................c....c................c....c..................................................................................
                    cccccccccccccccccccccccccccccccccccccccccccccccccccc......cccccccccccccccc......cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ....ccc..c.................ccc..c...........c..cccc..........................c.............c..cccc.........................cccc..c.......................c..cccc..
                    ..................................................................................................................................................................
                    ...............c..cccc...............c..................c..cccc.....c..cccc........c.cc..............c.......c.cccc.........................c..cccc...............
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
                    ..................................................................................................................................................................
        """),
        SpriteKind.Ground)
    ground1.set_position(scene.screen_width() / 2, 120)
    ground2.set_position(ground1.x + scene.screen_width(), 120)
    ground1.vx = -100
    ground2.vx = -100
    ground1.z = 2
    ground2.z = 2
def initRaptor():
    global raptor, run, jump, dead
    raptor = sprites.create(img("""
            ................................
                    ................................
                    ................................
                    ................................
                    ................................
                    ................................
                    ................................
                    ..........ffffffffffffffffffffff
                    ..........f99999999999999999999f
                    ..........f99999999999999999999f
                    ..........f9999999ffffff9999999f
                    ..........f9999999f....f9999999f
                    ..........f9999999f....f9999999f
                    ..........f9999999f....f9999999f
                    ..........f9999999f....f9999999f
                    ..........f9999999f....f9999999f
                    ..........f9999999f....f9999999f
                    ..........f9999999f....f9999999f
                    ..........f9999999f....f9999999f
                    ..........f9999999f....f9999999f
                    ..........f9999999ffffff9999999f
                    ..........f99999999999999999999f
                    ..........f99999999999999999999f
                    ..........f99999999999999999999f
                    ..........f99999999999999999999f
                    ..........f99999999999999999999f
                    ..........f99999999999999999999f
                    ..........fffff999999999999fffff
                    ..............f999999999999f....
                    ..............f999999999999f....
                    ..............f999999999999f....
                    ..............ffffffffffffff....
        """),
        SpriteKind.player)
    run = animation.create_animation(ActionKind.Walking, 100)
    run.add_animation_frame(img("""
        ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ..........ffffffffffffffffffffff
                ..........f99999999999999999999f
                ..........f99999999999999999999f
                ..........f9999999ffffff9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999ffffff9999999f
                ..........f99999999999999999999f
                ..........f99999999999999999999f
                ..........f99999999999999999999f
                ..........f99999999999999999999f
                ..........f99999999999999999999f
                ..........f99999999999999999999f
                ..........fffff999999999999fffff
                ..............f999999999999f....
                ..............f999999999999f....
                ..............f999999999999f....
                ..............ffffffffffffff....
    """))
    run.add_animation_frame(img("""
        ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ..........ffffffffffffffffffffff
                ..........f99999999999999999999f
                ..........f99999999999999999999f
                ..........f9999999ffffff9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999ffffff9999999f
                ..........f99999999999999999999f
                ..........f99999999999999999999f
                ..........f99999999999999999999f
                ..........f99999999999999999999f
                ..........f99999999999999999999f
                ..........f99999999999999999999f
                ..........fffff999999999999fffff
                ..............f999999999999f....
                ..............f999999999999f....
                ..............f999999999999f....
                ..............ffffffffffffff....
    """))
    animation.attach_animation(raptor, run)
    jump = animation.create_animation(ActionKind.Jumping, 200)
    jump.add_animation_frame(img("""
        ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ..........ffffffffffffffffffffff
                ..........f99999999999999999999f
                ..........f99999999999999999999f
                ..........f9999999ffffff9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999f....f9999999f
                ..........f9999999ffffff9999999f
                ..........f99999999999999999999f
                ..........f99999999999999999999f
                ..........f99999999999999999999f
                ..........f99999999999999999999f
                ..........f99999999999999999999f
                ..........f99999999999999999999f
                ..........fffff999999999999fffff
                ..............f999999999999f....
                ..............f999999999999f....
                ..............f999999999999f....
                ..............ffffffffffffff....
    """))
    animation.attach_animation(raptor, jump)
    dead = animation.create_animation(ActionKind.Dead, 200)
    dead.add_animation_frame(img("""
        ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ................................
                ..........ffffffffffffffffffffff
                ..........f22222222222222222222f
                ..........f22222222222222222222f
                ..........f2222222ffffff2222222f
                ..........f2222222f....f222ff22f
                ..........f2222222f....f222ff22f
                ..........f2222222f....f222ff22f
                ..........f2222222f....f222ff22f
                ..........f2222222f....f222ff22f
                ..........f2222222f....f222ff22f
                ..........f2222222f....f222ff22f
                ..........f2222222f....f2222222f
                ..........f2222222f....f222ff22f
                ..........f2222222ffffff222ff22f
                ..........f22222222222222222222f
                ..........f22222222222222222222f
                ..........f22222222222222222222f
                ..........f222222222ff222222222f
                ..........f22222222f22f22222222f
                ..........f22222222f22f22222222f
                ..........fffff2222f22f2222fffff
                ..............f22222ff22222f....
                ..............f222222222222f....
                ..............f222222222222f....
                ..............ffffffffffffff....
    """))
    animation.attach_animation(raptor, dead)
    raptor.z = 3
    raptor.set_position(15, 94)

def on_button_pressed():
    if raptor.y == 94 and end == 0:
        raptor.vy = -160
        animation.set_action(raptor, ActionKind.Jumping)
controller.any_button.on_event(ControllerButtonEvent.PRESSED, on_button_pressed)

def on_on_overlap(sprite, otherSprite):
    global end
    end = 1
    animation.set_action(raptor, ActionKind.Dead)
    pause(50)
    game.over(False, effects.dissolve)
sprites.on_overlap(SpriteKind.player, SpriteKind.projectile, on_on_overlap)

cloud: Sprite = None
cactus: Sprite = None
choice = 0
dead: animation.Animation = None
jump: animation.Animation = None
run: animation.Animation = None
raptor: Sprite = None
ground2: Sprite = None
ground1: Sprite = None
end = 0
idle = None
game.set_dialog_cursor(img("""
    ........................................
        ........................................
        ........................................
        ........................................
        ........................................
        ........................................
        ........................................
        ..................fff.........f.........
        ..........ffffffffffffffff...fef........
        ..ffffffffdfd1f1f4ddd4fe4dff.f4f........
        .fddd4444efdffffdfff4fffff4dffdff.......
        .fd44eeffef444444feeeeefe444d1d4f.......
        .f4eeff..feeffffffffffffffffffff........
        .feff...fefef1f1df......................
        .ff.....fe4f.ff1df......................
        .......fe4f...f1df......................
        .......fe4f....f1df.....................
        .......f4f.....f1df.....................
        ........ff......f1df....................
        ................f1df....................
        .................fff....................
        ........................................
        ........................................
        ........................................
        ........................................
        ........................................
        ........................................
        ........................................
        ........................................
        ........................................
        ........................................
        ........................................
"""))
idle = 0
game.splash("Run&Jump")
scene.set_background_color(1)
initGround()
initRaptor()
info.set_score(0)
end = 0
game.show_long_text("Press any button to jump.", DialogLayout.TOP)

def on_on_update():
    if raptor.y < 94:
        raptor.ay = 400
    else:
        raptor.ay = 0
        raptor.y = 94
        if end == 0:
            animation.set_action(raptor, ActionKind.Walking)
game.on_update(on_on_update)

def on_update_interval():
    info.change_score_by(2)
game.on_update_interval(50, on_update_interval)

def on_update_interval2():
    ground1.vx += -1
    ground2.vx += -1
game.on_update_interval(1000, on_update_interval2)

def on_update_interval3():
    global choice, cactus
    choice = randint(0, 4)
    if choice == 0:
        cactus = sprites.create_projectile_from_side(img("""
                ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ..............777...............
                            .............77777..............
                            .............77777..............
                            .............7f7f7...7..........
                            .........7...77777..777.........
                            ........777..77277..777.........
                            ........777..77277..777.........
                            ........777..77777..777.........
                            ........7777777777..777.........
                            ........7777777777..777.........
                            .........77777777777777.........
                            .............7777777777.........
                            .............777777777..........
                            .............77777..............
                            .............77777..............
                            .............77777..............
                            .............77777..............
                            .............77777..............
                            .............77777..............
                            .............77777..............
            """),
            ground1.vx,
            0)
        cactus.y = 94
        cactus.z = 2
    elif choice == 1:
        cactus = sprites.create_projectile_from_side(img("""
                ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ..............777...............
                            .............77777..............
                            .............fffff..............
                            .............ff7ff..............
                            .........7...77777...7..........
                            ........777..72227..777.........
                            ........777..77777..777.........
                            ........777..77777..777.........
                            ........777..7777777777.........
                            ........777..7777777777.........
                            ........77777777777777..........
                            ........7777777777..............
                            .........777777777..............
                            .............77777..............
                            .............77777..............
                            .............77777..............
                            .............77777..............
                            .............77777..............
                            .............77777..............
                            .............77777..............
            """),
            ground1.vx,
            0)
        cactus.y = 94
        cactus.z = 2
    elif choice == 2:
        cactus = sprites.create_projectile_from_side(img("""
                ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ...........8....................
                            ..........888......8............
                            ........8.f8f.....888...........
                            ........8.828.....f8f.8.........
                            ........88888.8...828.8.........
                            ..........818.8.8.88888.........
                            ..........81888.8.818...........
                            ..........818...88818...........
                            ..........818.....818...........
                            ..........818.....818...........
                            ..........818.....818...........
            """),
            ground1.vx,
            0)
        cactus.y = 94
        cactus.z = 2
game.on_update_interval(1000, on_update_interval3)

def on_update_interval4():
    if info.score() % 700 == 0:
        pass
game.on_update_interval(1, on_update_interval4)

def on_update_interval5():
    global cloud
    if Math.percent_chance(40):
        cloud = sprites.create_projectile_from_side(img("""
                ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................bbbb.bb.........
                            ...............bb.....b.........
                            .............bbb......bbb.......
                            .............b..........bbbb....
                            .............b.............b....
                            ..........bbbb.............bbb..
                            .........bb..................b..
                            .....bbbbb...................bb.
                            .....b........................b.
                            .bb.bb..b......................b
                            bb.......bbbbbbbbbbbbbbbbbbbbbbb
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
                            ................................
            """),
            ground1.vx / 4,
            0)
        cloud.y = randint(20, 60)
        cloud.set_kind(SpriteKind.Cloud)
        cloud.z = 1
game.on_update_interval(1500, on_update_interval5)

def on_forever():
    if ground2.x < -1 * (scene.screen_width() / 2):
        ground2.x = ground1.x + scene.screen_width()
forever(on_forever)

def on_forever2():
    if ground1.x < -1 * (scene.screen_width() / 2):
        ground1.x = ground2.x + scene.screen_width()
forever(on_forever2)
